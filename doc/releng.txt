-*- mode: outline; coding: iso-2022-7bit -*-
$Id$

リリースエンジニアリングについて

* 使っている道具
  GNU Automake 1.9.6
  GNU Autoconf 2.62
  GNU Emacs 23.0.60

* 作業用ディレクトリ
  configure.in の変更を伴うので、作業用ディレクトリでは
  % ./configure --enable-maintainer-mode
  としておくこと。

* リリース日時を宣言する
  適当に決める。リリースの一日前くらいから commit 禁止にする。
  (TBD: freeze しないでリリース用にブランチを切るのもいいかも。)
  前回のリリースからの ChangeLog をながめつつ、NEWS を更新する。

* β版のリリース
  configure.in の AM_INIT_AUTOMAKE を x.y.z-BETA に変えて
  % aclocal && autoconf && automake && make Makefiles && make dist elcdist
  する。tar 玉を http://navi2ch.sf.net/beta/ に置いて 2ch のスレで案内。
  (.elc の tar 玉には作成したホスト名・ユーザ名が埋め込まれるので注意。
  気になるなら compile farm で作業するとよい。
  https://sourceforge.net/docman/display_doc.php?docid=762&group_id=1
  shell server 上での作業はなるべく避ける。
  shell server 上で tar 玉を作ると中のファイルの UID が 65536 を超えてしまい、
  環境によっては展開時に警告が出てしまうため。)

* リリース版作成
  configure.in の AM_INIT_AUTOMAKE を x.y.z に変えて ChangeLog を記載、
  % aclocal && autoconf && automake && make Makefiles && make dist elcdist
  する。(これで configure や navi2ch-version.el などが更新される。)
  うまくいったら
  % cvs commit -m 'bump version to x.y.z'
  % cvs tag navi2ch-x_y_z
  でリリース元の準備をする。
  commit 忘れ等の確認のため、別ディレクトリで cvs export して
  % cd navi2ch-x.y.z && ./configure && make dist elcdist
  で tar 玉を作る。またまたよそのディレクトリに展開して配布物を確認、
  よさげなら SourceForge の File Release に置く。
  (置き方は以下の URL からヘルプを見ながら。
  https://sourceforge.net/project/admin/editpackages.php?group_id=39552 )

* リリースのアナウンス
  2ch のスレ、http://navi2ch.sf.net/、
  https://sourceforge.net/news/?group_id=39552 あたりでアナウンスをする。

* バージョンを開発版に変更
  configure.in の AM_INIT_AUTOMAKE を x.y.z-DEV に変えて ChangeLog を記載、
  % aclocal && autoconf && automake && make Makefiles && make
  して (最後の make を忘れると BUILT_SOURCES が更新されない)
  % cvs commit -m 'bump version to x.y.z-DEV'
  で commit する。
